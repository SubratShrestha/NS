#:import Factory kivy.factory.Factory
<MainWindow>:
    cols:2
    screen_manager: screen_manager
    side_bar: side_bar
    SideBar:
        id: side_bar
    ScreenManagement:
        id: screen_manager
<SideBar>:
    orientation: 'vertical'
    size_hint:0.3,1
    canvas.before:
        Color:
            rgb: .172,.184,.196
        Rectangle:
            size: self.size

    device_rv:device_rv
    Label:
        text:"NeuroStim"
        color:1,1,1,1
        font_size:45
        size_hint:1,0.1
        pos_hint:{"top":1}
    HomeButton:
    NewDeviceButton:
    DeviceRV:
        id: device_rv

<ScreenManagement>
    HomeScreen:
    DeviceScreen:

<HomeScreen>:
    name: "home"
    canvas.before:
        Color:
            rgb:1,1,1
        Rectangle:
            size: self.size
    BeginnerTutorial:
    GetHelp:
    LatestUpdate:
    ReportBug:
    SettingsHome:

<DeviceScreen>:
    name: "device"
    FloatLayout:
        Button:

###widgets for homescreen###
##################################################
<BeginnerTutorial@Button>:
    font_size: 20
    color: .1,.5,.6,1
    text: "Beginner Tutorial"
    background_color: 0.2,0.5,0.3,1
    size_hint: 0.3, 0.35
    pos_hint: {"x":0.65, "top":0.95}

<GetHelp@Button>:
    font_size: 20
    color: .1,.5,.6,1
    text: "Get Help"
    background_color: 0.2,0.5,0.3,1
    size_hint: 0.12, 0.08
    font_size: 15
    pos_hint: {"x":0.65, "top":0.53}

<ReportBug@Button>:
    font_size: 20
    color: .1,.5,.6,1
    text: "Report Bug"
    font_size: 15
    background_color: 0.2,0.5,0.3,1
    size_hint: 0.12, 0.08
    pos_hint: {"x":0.83, "top":0.53}

<LatestUpdate@Button>:
    font_size: 20
    color: .1,.5,.6,1
    text: "Latest Update"
    background_color: 0.2,0.5,0.3,1
    size_hint: 0.25, 0.5
    pos_hint: {"x":0.3, "top":0.95}

<SettingsHome@Button>:
    font_size: 20
    color: .1,.5,.6,1
    text: "Settings"
    background_color: 0.2,0.5,0.3,1
    size_hint: 0.65, 0.3
    pos_hint: {"x":0.3, "top":0.375}
##################################################


###widgets for sidebar###
##################################################
<DeviceRV>:
    size_hint: 1, 0.7
    pos_hint: {"x":0, "top":.85}
    background_color: 0.0,0.50,0,1
    viewclass: 'ConnectedDeviceSelectableLabel'
    SelectableRecycleBoxLayout:
        default_size_hint: 1, None
        size_hint_y: None
        height: self.minimum_height
        orientation: 'vertical'
        multiselect: False
        touch_multiselect: False
        spacing: 2

<AddDeviceSelectableLabel>:
    # Draw a background to indicate selection
    color:0,0,0,1
    canvas.before:
        Color:
            rgba: (.0, 0.9, .1, .3) if self.selected else (1, 1, 1, 1)
        RoundedRectangle:
            pos: self.pos
            size: self.size

<ConnectedDeviceSelectableLabel>:
    # Draw a background to indicate selection
    _label:_label
    canvas.before:
        Color:
            rgba: (.0, 0.9, .1, .3) if self.selected else (0.1, 0, 0.1, 1)
        Rectangle:
            pos: self.pos
            size: self.size
    Label:
        id: _label
        size_hint: 1, .2
        color: 1, 1, 0, 1
        font_size: 16
        valign: 'top'
        halign: 'center'
        pos_hint: {"x":0, "top":.95}
    Image:
        size_hint: .125, .125
        pos_hint: {"x":0.05, "top":0.6}
        source: './Icon2/working.png'
    Image:
        size_hint: .125, .125
        pos_hint: {"x":0.2, "top":0.6}
        source: './Icon2/working.png'
    Image:
        size_hint: .125, .125
        pos_hint: {"x":0.35, "top":0.6}
        source: './Icon2/not_working.png'
    Image:
        size_hint: .125, .125
        pos_hint: {"x":0.825, "top":0.6}
        source: './Icon2/malfunction.png'
    Image:
        size_hint: .2, .2
        pos_hint: {"x":0.75, "top":0.25}
        source: './Icon2/delete.png'
    Image:
        size_hint: .2, .2
        pos_hint: {"x":0.55, "top":0.25}
        source: './Icon2/Rename.png'
    Image:
        size_hint: .2, .2
        pos_hint: {"x":0.05, "top":0.25}
        source: './Icon2/battery.png'
    Label:
        size_hint: .2, .2
        pos_hint: {"x":0.275, "top":0.25}
        text: "89%"


<HomeButton@Button>
    text: "Home"
    font_size: 30
    color: 1,1,1,1
    size_hint: 1, 0.05
    pos_hint: {"top":0.9}
    background_color: .4,.4,.4,1
    on_press:
        app.root.screen_manager.transition.direction = 'down'
        app.root.screen_manager.current = 'home'

<AddDevicePopup@Popup>:
    title: "Bluetooth Discovery"
    title_size:35
    title_align:'center'
    separator_height:0
    ble_rv: ble_rv
    size_hint: .45,.73
    pos_hint: {"center_x":0.5,"center_y":0.5}
    auto_dismiss : True
    on_open: root.BluetoothDiscoverLoop()
    FloatLayout:
        canvas.before:
            Color:
                rgb:0.878,0.898,0.933
            Rectangle:
                size:self.size
                pos:self.pos
        RecycleView:
            id: ble_rv
            size_hint: 1, 0.895
            pos_hint: {"x":0, "top":1}
            viewclass: 'AddDeviceSelectableLabel'
            SelectableRecycleBoxLayout:
                default_size: None, dp(56)
                default_size_hint: 1, None
                size_hint_y: None
                height: self.minimum_height
                orientation: 'vertical'
                multiselect: False
                touch_multiselect: False
                spacing:dp(2)
        Label:
            size_hint: 1, 0.1
            pos_hint: {"x":0, "y":0}
            canvas.before:
                Color:
                    rgb:0.953,0.9608,0.9765
                Rectangle:
                    size:self.size
                    pos:self.pos
        Button:
            text: "Connect"
            size_hint: 0.3, 0.08
            pos_hint: {"x":0.65, "top":.09}
            background_color: 0.420,0.864,1.773,1
            on_press: root.Close()
        Button:
            text: "Refresh"
            size_hint: 0.3, 0.08
            pos_hint: {"x":0.05, "top":.09}
            background_color: 1,1,1,1
            on_press: root.BluetoothDiscoverLoop()

<NewDeviceButton@Button>
    font_size: 30
    color: 1,1,1,1
    size_hint: 1, 0.06
    text: "+ New Device"
    pos_hint: {"bottom":1}
    background_color: 0.420,0.864,1.773,1
    on_release: Factory.AddDevicePopup().open()
##################################################0.3451